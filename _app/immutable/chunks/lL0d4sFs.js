var Dn=Object.defineProperty;var Mn=(e,t,n)=>t in e?Dn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var S=(e,t,n)=>Mn(e,typeof t!="symbol"?t+"":t,n);import{a6 as Qt,G as Fe,C as R,ae as zn,af as Rn,D as Ln,B as Fn,g as Bt,X as Vn,H as jn,F as $t,I as he,M as fe,am as Pn,J as en,K as tn,L as qn,aq as nn,A as Hn,Q as Gn,n as It,az as Ve,x as Nt,aA as et,aB as Ut,aC as Kn,ap as Xn,aD as Zn,as as Yn,aE as tt,aF as Jn,ak as Wn,aG as rn,aH as Qn,z as er,aI as tr,aJ as nr,aK as rr,aL as Ue,t as nt,T as rt}from"./gyiEl3Uc.js";import{i as or,d as sr,f as ir,g as ar,j as cr,n as ot,a as st}from"./nuOQF-VX.js";import{r as it}from"./CtItQhWX.js";import"./BkNFsCzC.js";function ur(e,t){if(t){const n=document.body;e.autofocus=!0,Qt(()=>{document.activeElement===n&&e.focus()})}}let Ot=!1;function fr(){Ot||(Ot=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)(t=n.__on_r)==null||t.call(n)})},{capture:!0}))}function li(e,t){return t}function lr(e,t,n,r){for(var o=[],s=t.length,i=0;i<s;i++)Kn(t[i].e,o,!0);var c=s>0&&o.length===0&&n!==null;if(c){var u=n.parentNode;Xn(u),u.append(n),r.clear(),X(e,t[0].prev,t[s-1].next)}Zn(o,()=>{for(var g=0;g<s;g++){var l=t[g];c||(r.delete(l.k),X(e,l.prev,l.next)),Yn(l.e,!c)}})}function di(e,t,n,r,o,s=null){var i=e,c={items:new Map,first:null},u=(t&rn)!==0;if(u){var g=e;i=R?Fe(zn(g)):g.appendChild(Rn())}R&&Ln();var l=null,v=!1,y=Vn(()=>{var A=n();return Hn(A)?A:A==null?[]:nn(A)});Fn(()=>{var A=Bt(y),d=A.length;if(v&&d===0)return;v=d===0;let k=!1;if(R){var _=i.data===jn;_!==(d===0)&&(i=$t(),Fe(i),he(!1),k=!0)}if(R){for(var C=null,x,m=0;m<d;m++){if(fe.nodeType===8&&fe.data===Pn){i=fe,k=!0,he(!1);break}var p=A[m],b=r(p,m);x=on(fe,c,C,null,p,b,m,o,t,n),c.items.set(b,x),C=x}d>0&&Fe($t())}R||dr(A,c,i,o,t,r,n),s!==null&&(d===0?l?en(l):l=tn(()=>s(i)):l!==null&&qn(l,()=>{l=null})),k&&he(!0),Bt(y)}),R&&(i=fe)}function dr(e,t,n,r,o,s,i){var Et,kt,St,Tt;var c=(o&Qn)!==0,u=(o&(tt|et))!==0,g=e.length,l=t.items,v=t.first,y=v,A,d=null,k,_=[],C=[],x,m,p,b;if(c)for(b=0;b<g;b+=1)x=e[b],m=s(x,b),p=l.get(m),p!==void 0&&((Et=p.a)==null||Et.measure(),(k??(k=new Set)).add(p));for(b=0;b<g;b+=1){if(x=e[b],m=s(x,b),p=l.get(m),p===void 0){var $=y?y.e.nodes_start:n;d=on($,t,d,d===null?t.first:d.next,x,m,b,r,o,i),l.set(m,d),_=[],C=[],y=d.next;continue}if(u&&hr(p,x,b,o),p.e.f&Ve&&(en(p.e),c&&((kt=p.a)==null||kt.unfix(),(k??(k=new Set)).delete(p))),p!==y){if(A!==void 0&&A.has(p)){if(_.length<C.length){var I=C[0],N;d=I.prev;var J=_[0],Re=_[_.length-1];for(N=0;N<_.length;N+=1)Dt(_[N],I,n);for(N=0;N<C.length;N+=1)A.delete(C[N]);X(t,J.prev,Re.next),X(t,d,J),X(t,Re,I),y=I,d=Re,b-=1,_=[],C=[]}else A.delete(p),Dt(p,y,n),X(t,p.prev,p.next),X(t,p,d===null?t.first:d.next),X(t,d,p),d=p;continue}for(_=[],C=[];y!==null&&y.k!==m;)y.e.f&Ve||(A??(A=new Set)).add(y),C.push(y),y=y.next;if(y===null)continue;p=y}_.push(p),d=p,y=p.next}if(y!==null||A!==void 0){for(var ue=A===void 0?[]:nn(A);y!==null;)y.e.f&Ve||ue.push(y),y=y.next;var Le=ue.length;if(Le>0){var On=o&rn&&g===0?n:null;if(c){for(b=0;b<Le;b+=1)(St=ue[b].a)==null||St.measure();for(b=0;b<Le;b+=1)(Tt=ue[b].a)==null||Tt.fix()}lr(t,ue,On,l)}}c&&Qt(()=>{var Ct;if(k!==void 0)for(p of k)(Ct=p.a)==null||Ct.apply()}),Nt.first=t.first&&t.first.e,Nt.last=d&&d.e}function hr(e,t,n,r){r&tt&&Ut(e.v,t),r&et?Ut(e.i,n):e.i=n}function on(e,t,n,r,o,s,i,c,u,g){var l=(u&tt)!==0,v=(u&Jn)===0,y=l?v?Gn(o):It(o):o,A=u&et?It(i):i,d={i:A,v:y,k:s,a:null,e:null,prev:n,next:r};try{return d.e=tn(()=>c(e,y,A,g),R),d.e.prev=n&&n.e,d.e.next=r&&r.e,n===null?t.first=d:(n.next=d,n.e.next=d.e),r!==null&&(r.prev=d,r.e.prev=d.e),d}finally{}}function Dt(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,o=t?t.e.nodes_start:n,s=e.e.nodes_start;s!==r;){var i=Wn(s);o.before(s),s=i}}function X(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function sn(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=sn(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function pr(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=sn(e))&&(r&&(r+=" "),r+=t);return r}function yr(e){return typeof e=="object"?pr(e):e??""}function hi(e){if(R){var t=!1,n=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var r=e.value;He(e,"value",null),e.value=r}if(e.hasAttribute("checked")){var o=e.checked;He(e,"checked",null),e.checked=o}}};e.__on_r=n,rr(n),fr()}}function pi(e,t){var n=e.__attributes??(e.__attributes={});n.value===(n.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function gr(e,t){t?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function He(e,t,n,r){var o=e.__attributes??(e.__attributes={});R&&(o[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||o[t]!==(o[t]=n)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[tr]=n),n==null?e.removeAttribute(t):typeof n!="string"&&an(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function at(e,t,n,r,o=!1,s=!1,i=!1){let c=R&&s;c&&he(!1);var u=t||{},g=e.tagName==="OPTION";for(var l in t)l in n||(n[l]=null);n.class&&(n.class=yr(n.class));var v=an(e),y=e.__attributes??(e.__attributes={});for(const x in n){let m=n[x];if(g&&x==="value"&&m==null){e.value=e.__value="",u[x]=m;continue}var A=u[x];if(m!==A){u[x]=m;var d=x[0]+x[1];if(d!=="$$"){if(d==="on"){const p={},b="$$"+x;let $=x.slice(2);var k=cr($);if(or($)&&($=$.slice(0,-7),p.capture=!0),!k&&A){if(m!=null)continue;e.removeEventListener($,u[b],p),u[b]=null}if(m!=null)if(k)e[`__${$}`]=m,ir([$]);else{let I=function(N){u[x].call(this,N)};u[b]=sr($,e,I,p)}else k&&(e[`__${$}`]=void 0)}else if(x==="style"&&m!=null)e.style.cssText=m+"";else if(x==="autofocus")ur(e,!!m);else if(!s&&(x==="__value"||x==="value"&&m!=null))e.value=e.__value=m;else if(x==="selected"&&g)gr(e,m);else{var _=x;o||(_=ar(_));var C=_==="defaultValue"||_==="defaultChecked";if(m==null&&!s&&!C)if(y[x]=null,_==="value"||_==="checked"){let p=e;if(_==="value"){let b=p.defaultValue;p.removeAttribute(_),p.defaultValue=b}else{let b=p.defaultChecked;p.removeAttribute(_),p.defaultChecked=b}}else e.removeAttribute(x);else C||v.includes(_)&&(s||typeof m!="string")?e[_]=m:typeof m!="function"&&He(e,_,m)}x==="style"&&"__styles"in e&&(e.__styles={})}}}return c&&he(!0),u}var Mt=new Map;function an(e){var t=Mt.get(e.nodeName);if(t)return t;Mt.set(e.nodeName,t=[]);for(var n,r=e,o=Element.prototype;o!==r;){n=nr(r);for(var s in n)n[s].set&&t.push(s);r=er(r)}return t}function yi(e,t,n){var r=e.__className,o=wr(t);R&&e.className===o?e.__className=o:(r!==o||R&&e.className!==o)&&(t==null?e.removeAttribute("class"):e.className=o,e.__className=o)}function wr(e,t){return(e??"")+""}const mr=["string","number","bigint","symbol"],br=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function xr(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const t=typeof e;if(mr.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if(vr(e))return"Buffer";const n=_r(e);return n||"Object"}function vr(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function _r(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(br.includes(t))return t}class a{constructor(t,n,r){this.major=t,this.majorEncoded=t<<5,this.name=n,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}a.uint=new a(0,"uint",!0);a.negint=new a(1,"negint",!0);a.bytes=new a(2,"bytes",!0);a.string=new a(3,"string",!0);a.array=new a(4,"array",!1);a.map=new a(5,"map",!1);a.tag=new a(6,"tag",!1);a.float=new a(7,"float",!0);a.false=new a(7,"false",!0);a.true=new a(7,"true",!0);a.null=new a(7,"null",!0);a.undefined=new a(7,"undefined",!0);a.break=new a(7,"break",!0);class h{constructor(t,n,r){this.type=t,this.value=n,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const se=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Ar=new TextDecoder,Er=new TextEncoder;function Se(e){return se&&globalThis.Buffer.isBuffer(e)}function cn(e){return e instanceof Uint8Array?Se(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const kr=se?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):Rt(e,t,n):(e,t,n)=>n-t>64?Ar.decode(e.subarray(t,n)):Rt(e,t,n),Sr=se?e=>e.length>64?globalThis.Buffer.from(e):zt(e):e=>e.length>64?Er.encode(e):zt(e),P=e=>Uint8Array.from(e),ct=se?(e,t,n)=>Se(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),Tr=se?(e,t)=>(e=e.map(n=>n instanceof Uint8Array?n:globalThis.Buffer.from(n)),cn(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let r=0;for(let o of e)r+o.length>n.length&&(o=o.subarray(0,n.length-r)),n.set(o,r),r+=o.length;return n},Cr=se?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Br(e,t){if(Se(e)&&Se(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}function zt(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let o=e.charCodeAt(r);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=o&63|128):(o&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=o&63|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=o&63|128)}return t}function Rt(e,t,n){const r=[];for(;t<n;){const o=e[t];let s=null,i=o>239?4:o>223?3:o>191?2:1;if(t+i<=n){let c,u,g,l;switch(i){case 1:o<128&&(s=o);break;case 2:c=e[t+1],(c&192)===128&&(l=(o&31)<<6|c&63,l>127&&(s=l));break;case 3:c=e[t+1],u=e[t+2],(c&192)===128&&(u&192)===128&&(l=(o&15)<<12|(c&63)<<6|u&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:c=e[t+1],u=e[t+2],g=e[t+3],(c&192)===128&&(u&192)===128&&(g&192)===128&&(l=(o&15)<<18|(c&63)<<12|(u&63)<<6|g&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,i=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|s&1023),r.push(s),t+=i}return $r(r)}const Lt=4096;function $r(e){const t=e.length;if(t<=Lt)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Lt));return n}const Ir=256;class un{constructor(t=Ir){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let n=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const o=n.length-(this.maxCursor-this.cursor)-1;n.set(t,o)}else{if(n){const o=n.length-(this.maxCursor-this.cursor)-1;o<n.length&&(this.chunks[this.chunks.length-1]=n.subarray(0,o),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(n=Cr(this.chunkSize),this.chunks.push(n),this.maxCursor+=n.length,this._initReuseChunk===null&&(this._initReuseChunk=n),n.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let n;if(this.chunks.length===1){const r=this.chunks[0];t&&this.cursor>r.length/2?(n=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):n=ct(r,0,this.cursor)}else n=Tr(this.chunks,this.cursor);return t&&this.reset(),n}}const E="CBOR decode error:",fn="CBOR encode error:";function ie(e,t,n){if(e.length-t<n)throw new Error(`${E} not enough data for type`)}const U=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Q(e,t,n){ie(e,t,1);const r=e[t];if(n.strict===!0&&r<U[0])throw new Error(`${E} integer encoded in more bytes than necessary (strict decode)`);return r}function ee(e,t,n){ie(e,t,2);const r=e[t]<<8|e[t+1];if(n.strict===!0&&r<U[1])throw new Error(`${E} integer encoded in more bytes than necessary (strict decode)`);return r}function te(e,t,n){ie(e,t,4);const r=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(n.strict===!0&&r<U[2])throw new Error(`${E} integer encoded in more bytes than necessary (strict decode)`);return r}function ne(e,t,n){ie(e,t,8);const r=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],s=(BigInt(r)<<BigInt(32))+BigInt(o);if(n.strict===!0&&s<U[3])throw new Error(`${E} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(n.allowBigInt===!0)return s;throw new Error(`${E} integers outside of the safe integer range are not supported`)}function Nr(e,t,n,r){return new h(a.uint,Q(e,t+1,r),2)}function Ur(e,t,n,r){return new h(a.uint,ee(e,t+1,r),3)}function Or(e,t,n,r){return new h(a.uint,te(e,t+1,r),5)}function Dr(e,t,n,r){return new h(a.uint,ne(e,t+1,r),9)}function re(e,t){return L(e,0,t.value)}function L(e,t,n){if(n<U[0]){const r=Number(n);e.push([t|r])}else if(n<U[1]){const r=Number(n);e.push([t|24,r])}else if(n<U[2]){const r=Number(n);e.push([t|25,r>>>8,r&255])}else if(n<U[3]){const r=Number(n);e.push([t|26,r>>>24&255,r>>>16&255,r>>>8&255,r&255])}else{const r=BigInt(n);if(r<U[4]){const o=[t|27,0,0,0,0,0,0,0];let s=Number(r&BigInt(4294967295)),i=Number(r>>BigInt(32)&BigInt(4294967295));o[8]=s&255,s=s>>8,o[7]=s&255,s=s>>8,o[6]=s&255,s=s>>8,o[5]=s&255,o[4]=i&255,i=i>>8,o[3]=i&255,i=i>>8,o[2]=i&255,i=i>>8,o[1]=i&255,e.push(o)}else throw new Error(`${E} encountered BigInt larger than allowable range`)}}re.encodedSize=function(t){return L.encodedSize(t.value)};L.encodedSize=function(t){return t<U[0]?1:t<U[1]?2:t<U[2]?3:t<U[3]?5:9};re.compareTokens=function(t,n){return t.value<n.value?-1:t.value>n.value?1:0};function Mr(e,t,n,r){return new h(a.negint,-1-Q(e,t+1,r),2)}function zr(e,t,n,r){return new h(a.negint,-1-ee(e,t+1,r),3)}function Rr(e,t,n,r){return new h(a.negint,-1-te(e,t+1,r),5)}const ut=BigInt(-1),ln=BigInt(1);function Lr(e,t,n,r){const o=ne(e,t+1,r);if(typeof o!="bigint"){const s=-1-o;if(s>=Number.MIN_SAFE_INTEGER)return new h(a.negint,s,9)}if(r.allowBigInt!==!0)throw new Error(`${E} integers outside of the safe integer range are not supported`);return new h(a.negint,ut-BigInt(o),9)}function ft(e,t){const n=t.value,r=typeof n=="bigint"?n*ut-ln:n*-1-1;L(e,t.type.majorEncoded,r)}ft.encodedSize=function(t){const n=t.value,r=typeof n=="bigint"?n*ut-ln:n*-1-1;return r<U[0]?1:r<U[1]?2:r<U[2]?3:r<U[3]?5:9};ft.compareTokens=function(t,n){return t.value<n.value?1:t.value>n.value?-1:0};function me(e,t,n,r){ie(e,t,n+r);const o=ct(e,t+n,t+n+r);return new h(a.bytes,o,n+r)}function Fr(e,t,n,r){return me(e,t,1,n)}function Vr(e,t,n,r){return me(e,t,2,Q(e,t+1,r))}function jr(e,t,n,r){return me(e,t,3,ee(e,t+1,r))}function Pr(e,t,n,r){return me(e,t,5,te(e,t+1,r))}function qr(e,t,n,r){const o=ne(e,t+1,r);if(typeof o=="bigint")throw new Error(`${E} 64-bit integer bytes lengths not supported`);return me(e,t,9,o)}function Te(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===a.string?Sr(e.value):e.value),e.encodedBytes}function Oe(e,t){const n=Te(t);L(e,t.type.majorEncoded,n.length),e.push(n)}Oe.encodedSize=function(t){const n=Te(t);return L.encodedSize(n.length)+n.length};Oe.compareTokens=function(t,n){return Hr(Te(t),Te(n))};function Hr(e,t){return e.length<t.length?-1:e.length>t.length?1:Br(e,t)}function be(e,t,n,r,o){const s=n+r;ie(e,t,s);const i=new h(a.string,kr(e,t+n,t+s),s);return o.retainStringBytes===!0&&(i.byteValue=ct(e,t+n,t+s)),i}function Gr(e,t,n,r){return be(e,t,1,n,r)}function Kr(e,t,n,r){return be(e,t,2,Q(e,t+1,r),r)}function Xr(e,t,n,r){return be(e,t,3,ee(e,t+1,r),r)}function Zr(e,t,n,r){return be(e,t,5,te(e,t+1,r),r)}function Yr(e,t,n,r){const o=ne(e,t+1,r);if(typeof o=="bigint")throw new Error(`${E} 64-bit integer string lengths not supported`);return be(e,t,9,o,r)}const Jr=Oe;function ae(e,t,n,r){return new h(a.array,r,n)}function Wr(e,t,n,r){return ae(e,t,1,n)}function Qr(e,t,n,r){return ae(e,t,2,Q(e,t+1,r))}function eo(e,t,n,r){return ae(e,t,3,ee(e,t+1,r))}function to(e,t,n,r){return ae(e,t,5,te(e,t+1,r))}function no(e,t,n,r){const o=ne(e,t+1,r);if(typeof o=="bigint")throw new Error(`${E} 64-bit integer array lengths not supported`);return ae(e,t,9,o)}function ro(e,t,n,r){if(r.allowIndefinite===!1)throw new Error(`${E} indefinite length items not allowed`);return ae(e,t,1,1/0)}function lt(e,t){L(e,a.array.majorEncoded,t.value)}lt.compareTokens=re.compareTokens;lt.encodedSize=function(t){return L.encodedSize(t.value)};function ce(e,t,n,r){return new h(a.map,r,n)}function oo(e,t,n,r){return ce(e,t,1,n)}function so(e,t,n,r){return ce(e,t,2,Q(e,t+1,r))}function io(e,t,n,r){return ce(e,t,3,ee(e,t+1,r))}function ao(e,t,n,r){return ce(e,t,5,te(e,t+1,r))}function co(e,t,n,r){const o=ne(e,t+1,r);if(typeof o=="bigint")throw new Error(`${E} 64-bit integer map lengths not supported`);return ce(e,t,9,o)}function uo(e,t,n,r){if(r.allowIndefinite===!1)throw new Error(`${E} indefinite length items not allowed`);return ce(e,t,1,1/0)}function dt(e,t){L(e,a.map.majorEncoded,t.value)}dt.compareTokens=re.compareTokens;dt.encodedSize=function(t){return L.encodedSize(t.value)};function fo(e,t,n,r){return new h(a.tag,n,1)}function lo(e,t,n,r){return new h(a.tag,Q(e,t+1,r),2)}function ho(e,t,n,r){return new h(a.tag,ee(e,t+1,r),3)}function po(e,t,n,r){return new h(a.tag,te(e,t+1,r),5)}function yo(e,t,n,r){return new h(a.tag,ne(e,t+1,r),9)}function ht(e,t){L(e,a.tag.majorEncoded,t.value)}ht.compareTokens=re.compareTokens;ht.encodedSize=function(t){return L.encodedSize(t.value)};const go=20,wo=21,mo=22,bo=23;function xo(e,t,n,r){if(r.allowUndefined===!1)throw new Error(`${E} undefined values are not supported`);return r.coerceUndefinedToNull===!0?new h(a.null,null,1):new h(a.undefined,void 0,1)}function vo(e,t,n,r){if(r.allowIndefinite===!1)throw new Error(`${E} indefinite length items not allowed`);return new h(a.break,void 0,1)}function pt(e,t,n){if(n){if(n.allowNaN===!1&&Number.isNaN(e))throw new Error(`${E} NaN values are not supported`);if(n.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${E} Infinity values are not supported`)}return new h(a.float,e,t)}function _o(e,t,n,r){return pt(gt(e,t+1),3,r)}function Ao(e,t,n,r){return pt(wt(e,t+1),5,r)}function Eo(e,t,n,r){return pt(yn(e,t+1),9,r)}function yt(e,t,n){const r=t.value;if(r===!1)e.push([a.float.majorEncoded|go]);else if(r===!0)e.push([a.float.majorEncoded|wo]);else if(r===null)e.push([a.float.majorEncoded|mo]);else if(r===void 0)e.push([a.float.majorEncoded|bo]);else{let o,s=!1;(!n||n.float64!==!0)&&(hn(r),o=gt(F,1),r===o||Number.isNaN(r)?(F[0]=249,e.push(F.slice(0,3)),s=!0):(pn(r),o=wt(F,1),r===o&&(F[0]=250,e.push(F.slice(0,5)),s=!0))),s||(ko(r),o=yn(F,1),F[0]=251,e.push(F.slice(0,9)))}}yt.encodedSize=function(t,n){const r=t.value;if(r===!1||r===!0||r===null||r===void 0)return 1;if(!n||n.float64!==!0){hn(r);let o=gt(F,1);if(r===o||Number.isNaN(r))return 3;if(pn(r),o=wt(F,1),r===o)return 5}return 9};const dn=new ArrayBuffer(9),z=new DataView(dn,1),F=new Uint8Array(dn,0);function hn(e){if(e===1/0)z.setUint16(0,31744,!1);else if(e===-1/0)z.setUint16(0,64512,!1);else if(Number.isNaN(e))z.setUint16(0,32256,!1);else{z.setFloat32(0,e);const t=z.getUint32(0),n=(t&2139095040)>>23,r=t&8388607;if(n===255)z.setUint16(0,31744,!1);else if(n===0)z.setUint16(0,(e&2147483648)>>16|r>>13,!1);else{const o=n-127;o<-24?z.setUint16(0,0):o<-14?z.setUint16(0,(t&2147483648)>>16|1<<24+o,!1):z.setUint16(0,(t&2147483648)>>16|o+15<<10|r>>13,!1)}}}function gt(e,t){if(e.length-t<2)throw new Error(`${E} not enough data for float16`);const n=(e[t]<<8)+e[t+1];if(n===31744)return 1/0;if(n===64512)return-1/0;if(n===32256)return NaN;const r=n>>10&31,o=n&1023;let s;return r===0?s=o*2**-24:r!==31?s=(o+1024)*2**(r-25):s=o===0?1/0:NaN,n&32768?-s:s}function pn(e){z.setFloat32(0,e,!1)}function wt(e,t){if(e.length-t<4)throw new Error(`${E} not enough data for float32`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function ko(e){z.setFloat64(0,e,!1)}function yn(e,t){if(e.length-t<8)throw new Error(`${E} not enough data for float64`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}yt.compareTokens=re.compareTokens;function T(e,t,n){throw new Error(`${E} encountered invalid minor (${n}) for major ${e[t]>>>5}`)}function De(e){return()=>{throw new Error(`${E} ${e}`)}}const f=[];for(let e=0;e<=23;e++)f[e]=T;f[24]=Nr;f[25]=Ur;f[26]=Or;f[27]=Dr;f[28]=T;f[29]=T;f[30]=T;f[31]=T;for(let e=32;e<=55;e++)f[e]=T;f[56]=Mr;f[57]=zr;f[58]=Rr;f[59]=Lr;f[60]=T;f[61]=T;f[62]=T;f[63]=T;for(let e=64;e<=87;e++)f[e]=Fr;f[88]=Vr;f[89]=jr;f[90]=Pr;f[91]=qr;f[92]=T;f[93]=T;f[94]=T;f[95]=De("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)f[e]=Gr;f[120]=Kr;f[121]=Xr;f[122]=Zr;f[123]=Yr;f[124]=T;f[125]=T;f[126]=T;f[127]=De("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)f[e]=Wr;f[152]=Qr;f[153]=eo;f[154]=to;f[155]=no;f[156]=T;f[157]=T;f[158]=T;f[159]=ro;for(let e=160;e<=183;e++)f[e]=oo;f[184]=so;f[185]=io;f[186]=ao;f[187]=co;f[188]=T;f[189]=T;f[190]=T;f[191]=uo;for(let e=192;e<=215;e++)f[e]=fo;f[216]=lo;f[217]=ho;f[218]=po;f[219]=yo;f[220]=T;f[221]=T;f[222]=T;f[223]=T;for(let e=224;e<=243;e++)f[e]=De("simple values are not supported");f[244]=T;f[245]=T;f[246]=T;f[247]=xo;f[248]=De("simple values are not supported");f[249]=_o;f[250]=Ao;f[251]=Eo;f[252]=T;f[253]=T;f[254]=T;f[255]=vo;const j=[];for(let e=0;e<24;e++)j[e]=new h(a.uint,e,1);for(let e=-1;e>=-24;e--)j[31-e]=new h(a.negint,e,1);j[64]=new h(a.bytes,new Uint8Array(0),1);j[96]=new h(a.string,"",1);j[128]=new h(a.array,0,1);j[160]=new h(a.map,0,1);j[244]=new h(a.false,!1,1);j[245]=new h(a.true,!0,1);j[246]=new h(a.null,null,1);function So(e){switch(e.type){case a.false:return P([244]);case a.true:return P([245]);case a.null:return P([246]);case a.bytes:return e.value.length?void 0:P([64]);case a.string:return e.value===""?P([96]):void 0;case a.array:return e.value===0?P([128]):void 0;case a.map:return e.value===0?P([160]):void 0;case a.uint:return e.value<24?P([Number(e.value)]):void 0;case a.negint:if(e.value>=-24)return P([31-Number(e.value)])}}const To={float64:!1,mapSorter:$o,quickEncodeToken:So};function Co(){const e=[];return e[a.uint.major]=re,e[a.negint.major]=ft,e[a.bytes.major]=Oe,e[a.string.major]=Jr,e[a.array.major]=lt,e[a.map.major]=dt,e[a.tag.major]=ht,e[a.float.major]=yt,e}const gn=Co(),je=new un;class Ce{constructor(t,n){this.obj=t,this.parent=n}includes(t){let n=this;do if(n.obj===t)return!0;while(n=n.parent);return!1}static createCheck(t,n){if(t&&t.includes(n))throw new Error(`${fn} object contains circular references`);return new Ce(n,t)}}const G={null:new h(a.null,null),undefined:new h(a.undefined,void 0),true:new h(a.true,!0),false:new h(a.false,!1),emptyArray:new h(a.array,0),emptyMap:new h(a.map,0)},Y={number(e,t,n,r){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new h(a.float,e):e>=0?new h(a.uint,e):new h(a.negint,e)},bigint(e,t,n,r){return e>=BigInt(0)?new h(a.uint,e):new h(a.negint,e)},Uint8Array(e,t,n,r){return new h(a.bytes,e)},string(e,t,n,r){return new h(a.string,e)},boolean(e,t,n,r){return e?G.true:G.false},null(e,t,n,r){return G.null},undefined(e,t,n,r){return G.undefined},ArrayBuffer(e,t,n,r){return new h(a.bytes,new Uint8Array(e))},DataView(e,t,n,r){return new h(a.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,n,r){if(!e.length)return n.addBreakTokens===!0?[G.emptyArray,new h(a.break)]:G.emptyArray;r=Ce.createCheck(r,e);const o=[];let s=0;for(const i of e)o[s++]=_e(i,n,r);return n.addBreakTokens?[new h(a.array,e.length),o,new h(a.break)]:[new h(a.array,e.length),o]},Object(e,t,n,r){const o=t!=="Object",s=o?e.keys():Object.keys(e),i=o?e.size:s.length;if(!i)return n.addBreakTokens===!0?[G.emptyMap,new h(a.break)]:G.emptyMap;r=Ce.createCheck(r,e);const c=[];let u=0;for(const g of s)c[u++]=[_e(g,n,r),_e(o?e.get(g):e[g],n,r)];return Bo(c,n),n.addBreakTokens?[new h(a.map,i),c,new h(a.break)]:[new h(a.map,i),c]}};Y.Map=Y.Object;Y.Buffer=Y.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Y[`${e}Array`]=Y.DataView;function _e(e,t={},n){const r=xr(e),o=t&&t.typeEncoders&&t.typeEncoders[r]||Y[r];if(typeof o=="function"){const i=o(e,r,t,n);if(i!=null)return i}const s=Y[r];if(!s)throw new Error(`${fn} unsupported type: ${r}`);return s(e,r,t,n)}function Bo(e,t){t.mapSorter&&e.sort(t.mapSorter)}function $o(e,t){const n=Array.isArray(e[0])?e[0][0]:e[0],r=Array.isArray(t[0])?t[0][0]:t[0];if(n.type!==r.type)return n.type.compare(r.type);const o=n.type.major,s=gn[o].compareTokens(n,r);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function wn(e,t,n,r){if(Array.isArray(t))for(const o of t)wn(e,o,n,r);else n[t.type.major](e,t,r)}function Io(e,t,n){const r=_e(e,n);if(!Array.isArray(r)&&n.quickEncodeToken){const o=n.quickEncodeToken(r);if(o)return o;const s=t[r.type.major];if(s.encodedSize){const i=s.encodedSize(r,n),c=new un(i);if(s(c,r,n),c.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${r} was wrong`);return cn(c.chunks[0])}}return je.reset(),wn(je,r,t,n),je.toBytes(!0)}function No(e,t){return t=Object.assign({},To,t),Io(e,gn,t)}const Uo={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Oo{constructor(t,n={}){this._pos=0,this.data=t,this.options=n}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let n=j[t];if(n===void 0){const r=f[t];if(!r)throw new Error(`${E} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const o=t&31;n=r(this.data,this._pos,o,this.options)}return this._pos+=n.encodedLength,n}}const pe=Symbol.for("DONE"),Me=Symbol.for("BREAK");function Do(e,t,n){const r=[];for(let o=0;o<e.value;o++){const s=ye(t,n);if(s===Me){if(e.value===1/0)break;throw new Error(`${E} got unexpected break to lengthed array`)}if(s===pe)throw new Error(`${E} found array but not enough entries (got ${o}, expected ${e.value})`);r[o]=s}return r}function Mo(e,t,n){const r=n.useMaps===!0,o=r?void 0:{},s=r?new Map:void 0;for(let i=0;i<e.value;i++){const c=ye(t,n);if(c===Me){if(e.value===1/0)break;throw new Error(`${E} got unexpected break to lengthed map`)}if(c===pe)throw new Error(`${E} found map but not enough entries (got ${i} [no key], expected ${e.value})`);if(r!==!0&&typeof c!="string")throw new Error(`${E} non-string keys not supported (got ${typeof c})`);if(n.rejectDuplicateMapKeys===!0&&(r&&s.has(c)||!r&&c in o))throw new Error(`${E} found repeat map key "${c}"`);const u=ye(t,n);if(u===pe)throw new Error(`${E} found map but not enough entries (got ${i} [no value], expected ${e.value})`);r?s.set(c,u):o[c]=u}return r?s:o}function ye(e,t){if(e.done())return pe;const n=e.next();if(n.type===a.break)return Me;if(n.type.terminal)return n.value;if(n.type===a.array)return Do(n,e,t);if(n.type===a.map)return Mo(n,e,t);if(n.type===a.tag){if(t.tags&&typeof t.tags[n.value]=="function"){const r=ye(e,t);return t.tags[n.value](r)}throw new Error(`${E} tag not supported (${n.value})`)}throw new Error("unsupported")}function zo(e,t){if(!(e instanceof Uint8Array))throw new Error(`${E} data to decode must be a Uint8Array`);t=Object.assign({},Uo,t);const n=t.tokenizer||new Oo(e,t),r=ye(n,t);if(r===pe)throw new Error(`${E} did not find any content to decode`);if(r===Me)throw new Error(`${E} got unexpected break`);return[r,e.subarray(n.pos())]}function Ro(e,t){const[n,r]=zo(e,t);if(r.length>0)throw new Error(`${E} too many terminals, data makes no sense`);return n}function Lo(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}function mt(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function Fo(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(n[i]!==255)throw new TypeError(s+" is ambiguous");n[i]=o}var c=e.length,u=e.charAt(0),g=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function v(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var k=0,_=0,C=0,x=d.length;C!==x&&d[C]===0;)C++,k++;for(var m=(x-C)*l+1>>>0,p=new Uint8Array(m);C!==x;){for(var b=d[C],$=0,I=m-1;(b!==0||$<_)&&I!==-1;I--,$++)b+=256*p[I]>>>0,p[I]=b%c>>>0,b=b/c>>>0;if(b!==0)throw new Error("Non-zero carry");_=$,C++}for(var N=m-_;N!==m&&p[N]===0;)N++;for(var J=u.repeat(k);N<m;++N)J+=e.charAt(p[N]);return J}function y(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var k=0;if(d[k]!==" "){for(var _=0,C=0;d[k]===u;)_++,k++;for(var x=(d.length-k)*g+1>>>0,m=new Uint8Array(x);d[k];){var p=n[d.charCodeAt(k)];if(p===255)return;for(var b=0,$=x-1;(p!==0||b<C)&&$!==-1;$--,b++)p+=c*m[$]>>>0,m[$]=p%256>>>0,p=p/256>>>0;if(p!==0)throw new Error("Non-zero carry");C=b,k++}if(d[k]!==" "){for(var I=x-C;I!==x&&m[I]===0;)I++;for(var N=new Uint8Array(_+(x-I)),J=_;I!==x;)N[J++]=m[I++];return N}}}function A(d){var k=y(d);if(k)return k;throw new Error(`Non-${t} character`)}return{encode:v,decodeUnsafe:y,decode:A}}var Vo=Fo,jo=Vo;class Po{constructor(t,n,r){S(this,"name");S(this,"prefix");S(this,"baseEncode");this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class qo{constructor(t,n,r){S(this,"name");S(this,"prefix");S(this,"baseDecode");S(this,"prefixCodePoint");this.name=t,this.prefix=n;const o=n.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return mn(this,t)}}class Ho{constructor(t){S(this,"decoders");this.decoders=t}or(t){return mn(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r!=null)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function mn(e,t){return new Ho({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class Go{constructor(t,n,r,o){S(this,"name");S(this,"prefix");S(this,"baseEncode");S(this,"baseDecode");S(this,"encoder");S(this,"decoder");this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=o,this.encoder=new Po(t,n,r),this.decoder=new qo(t,n,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}function bn({name:e,prefix:t,encode:n,decode:r}){return new Go(e,t,n,r)}function ze({name:e,prefix:t,alphabet:n}){const{encode:r,decode:o}=jo(n,e);return bn({prefix:t,name:e,encode:r,decode:s=>mt(o(s))})}function Ko(e,t,n,r){const o={};for(let l=0;l<t.length;++l)o[t[l]]=l;let s=e.length;for(;e[s-1]==="=";)--s;const i=new Uint8Array(s*n/8|0);let c=0,u=0,g=0;for(let l=0;l<s;++l){const v=o[e[l]];if(v===void 0)throw new SyntaxError(`Non-${r} character`);u=u<<n|v,c+=n,c>=8&&(c-=8,i[g++]=255&u>>c)}if(c>=n||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return i}function Xo(e,t,n){const r=t[t.length-1]==="=",o=(1<<n)-1;let s="",i=0,c=0;for(let u=0;u<e.length;++u)for(c=c<<8|e[u],i+=8;i>n;)i-=n,s+=t[o&c>>i];if(i!==0&&(s+=t[o&c<<n-i]),r)for(;s.length*n&7;)s+="=";return s}function H({name:e,prefix:t,bitsPerChar:n,alphabet:r}){return bn({prefix:t,name:e,encode(o){return Xo(o,r,n)},decode(o){return Ko(o,r,n,e)}})}const Ae=H({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});H({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});H({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});H({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});H({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});H({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});H({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});H({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});H({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const Pe=ze({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});ze({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const Z=ze({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});ze({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Zo=xn,Ft=128,Yo=-128,Jo=Math.pow(2,31);function xn(e,t,n){t=t||[],n=n||0;for(var r=n;e>=Jo;)t[n++]=e&255|Ft,e/=128;for(;e&Yo;)t[n++]=e&255|Ft,e>>>=7;return t[n]=e|0,xn.bytes=n-r+1,t}var Wo=Ge,Qo=128,Vt=127;function Ge(e,r){var n=0,r=r||0,o=0,s=r,i,c=e.length;do{if(s>=c)throw Ge.bytes=0,new RangeError("Could not decode varint");i=e[s++],n+=o<28?(i&Vt)<<o:(i&Vt)*Math.pow(2,o),o+=7}while(i>=Qo);return Ge.bytes=s-r,n}var es=Math.pow(2,7),ts=Math.pow(2,14),ns=Math.pow(2,21),rs=Math.pow(2,28),os=Math.pow(2,35),ss=Math.pow(2,42),is=Math.pow(2,49),as=Math.pow(2,56),cs=Math.pow(2,63),us=function(e){return e<es?1:e<ts?2:e<ns?3:e<rs?4:e<os?5:e<ss?6:e<is?7:e<as?8:e<cs?9:10},fs={encode:Zo,decode:Wo,encodingLength:us},Be=fs;function Ke(e,t=0){return[Be.decode(e,t),Be.decode.bytes]}function $e(e,t,n=0){return Be.encode(e,t,n),t}function Ie(e){return Be.encodingLength(e)}function Xe(e,t){const n=t.byteLength,r=Ie(e),o=r+Ie(n),s=new Uint8Array(o+n);return $e(e,s,0),$e(n,s,r),s.set(t,o),new bt(e,n,t,s)}function ls(e){const t=mt(e),[n,r]=Ke(t),[o,s]=Ke(t.subarray(r)),i=t.subarray(r+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new bt(n,o,i,t)}function ds(e,t){if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&Lo(e.bytes,n.bytes)}}class bt{constructor(t,n,r,o){S(this,"code");S(this,"size");S(this,"digest");S(this,"bytes");this.code=t,this.size=n,this.digest=r,this.bytes=o}}function jt(e,t){const{bytes:n,version:r}=e;switch(r){case 0:return ps(n,Ze(e),t??Z.encoder);default:return ys(n,Ze(e),t??Ae.encoder)}}const Pt=new WeakMap;function Ze(e){const t=Pt.get(e);if(t==null){const n=new Map;return Pt.set(e,n),n}return t}var Wt;class B{constructor(t,n,r,o){S(this,"code");S(this,"version");S(this,"multihash");S(this,"bytes");S(this,"/");S(this,Wt,"CID");this.code=n,this.version=t,this.multihash=r,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:n}=this;if(t!==le)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(n.code!==gs)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return B.createV0(n)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:n}=this.multihash,r=Xe(t,n);return B.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return B.equals(this,t)}static equals(t,n){const r=n;return r!=null&&t.code===r.code&&t.version===r.version&&ds(t.multihash,r.multihash)}toString(t){return jt(this,t)}toJSON(){return{"/":jt(this)}}link(){return this}[(Wt=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;const n=t;if(n instanceof B)return n;if(n["/"]!=null&&n["/"]===n.bytes||n.asCID===n){const{version:r,code:o,multihash:s,bytes:i}=n;return new B(r,o,s,i??qt(r,o,s.bytes))}else if(n[ws]===!0){const{version:r,multihash:o,code:s}=n,i=ls(o);return B.create(r,s,i)}else return null}static create(t,n,r){if(typeof n!="number")throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(n!==le)throw new Error(`Version 0 CID must use dag-pb (code: ${le}) block encoding`);return new B(t,n,r,r.bytes)}case 1:{const o=qt(t,n,r.bytes);return new B(t,n,r,o)}default:throw new Error("Invalid version")}}static createV0(t){return B.create(0,le,t)}static createV1(t,n){return B.create(1,t,n)}static decode(t){const[n,r]=B.decodeFirst(t);if(r.length!==0)throw new Error("Incorrect length");return n}static decodeFirst(t){const n=B.inspectBytes(t),r=n.size-n.multihashSize,o=mt(t.subarray(r,r+n.multihashSize));if(o.byteLength!==n.multihashSize)throw new Error("Incorrect length");const s=o.subarray(n.multihashSize-n.digestSize),i=new bt(n.multihashCode,n.digestSize,s,o);return[n.version===0?B.createV0(i):B.createV1(n.codec,i),t.subarray(n.size)]}static inspectBytes(t){let n=0;const r=()=>{const[v,y]=Ke(t.subarray(n));return n+=y,v};let o=r(),s=le;if(o===18?(o=0,n=0):s=r(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const i=n,c=r(),u=r(),g=n+u,l=g-i;return{version:o,codec:s,multihashCode:c,digestSize:u,multihashSize:l,size:g}}static parse(t,n){const[r,o]=hs(t,n),s=B.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Ze(s).set(r,t),s}}function hs(e,t){switch(e[0]){case"Q":{const n=t??Z;return[Z.prefix,n.decode(`${Z.prefix}${e}`)]}case Z.prefix:{const n=t??Z;return[Z.prefix,n.decode(e)]}case Ae.prefix:{const n=t??Ae;return[Ae.prefix,n.decode(e)]}case Pe.prefix:{const n=t??Pe;return[Pe.prefix,n.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function ps(e,t,n){const{prefix:r}=n;if(r!==Z.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const o=t.get(r);if(o==null){const s=n.encode(e).slice(1);return t.set(r,s),s}else return o}function ys(e,t,n){const{prefix:r}=n,o=t.get(r);if(o==null){const s=n.encode(e);return t.set(r,s),s}else return o}const le=112,gs=18;function qt(e,t,n){const r=Ie(e),o=r+Ie(t),s=new Uint8Array(o+n.byteLength);return $e(e,s,0),$e(t,s,r),s.set(n,o),s}const ws=Symbol.for("@ipld/js-cid/CID"),vn=42;function _n(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function ms(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=B.asCID(e);if(!t)return null;const n=new Uint8Array(t.bytes.byteLength+1);return n.set(t.bytes,1),[new h(a.tag,vn),new h(a.bytes,n)]}function bs(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function xs(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const Ye={float64:!0,typeEncoders:{Object:ms,undefined:bs,number:xs}},vs={...Ye,typeEncoders:{...Ye.typeEncoders}};function _s(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return B.decode(e.subarray(1))}const Ne={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Ne.tags[vn]=_s;const As={...Ne,tags:Ne.tags.slice()},Es="dag-cbor",ks=113,Ss=e=>No(e,Ye),An=e=>Ro(_n(e),Ne),En=Object.freeze(Object.defineProperty({__proto__:null,code:ks,decode:An,decodeOptions:As,encode:Ss,encodeOptions:vs,name:Es,toByteView:_n},Symbol.toStringTag,{value:"Module"})),Ts=Ue([{name:"D.Guttenfelder",key:"d8b304cdf6fca3c8c7db9932f92aac84eec095d8e166b6c13dabfe28091fec7b"}]),Cs=[{name:"D. Guttenfelder",url:"https://stanford.aa.dev.starlinglab.org"},{name:"K. Pollack",url:"https://kira.aa.prod.starlinglab.org"},{name:"C. Morris",url:"https://chris.aa.prod.starlinglab.org"}],Bs=()=>{if(typeof localStorage<"u"){const e=localStorage.getItem("aa-explorer-endpoints");if(e)try{const t=JSON.parse(e);if(t&&t.length>0)return t}catch(t){console.error("Failed to parse stored endpoints:",t)}}return[...Cs]},xt=Ue(Bs()),gi=Ue(null);xt.subscribe(e=>{typeof localStorage<"u"&&localStorage.setItem("aa-explorer-endpoints",JSON.stringify(e))});const $s={show:!1,kind:"hash",data:null,selectedCID:null},kn=Ue($s);function wi(e,t,n){kn.set({show:!0,kind:e,data:t,selectedCID:n})}function mi(){kn.update(e=>({...e,show:!1}))}var Is=ot('<svg><path fill="currentColor" d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10s10-4.5 10-10S17.5 2 12 2m-2 15l-5-5l1.41-1.41L10 14.17l7.59-7.59L19 8z"></path></svg>');function bi(e,t){const n=it(t,["$$slots","$$events","$$legacy"]);var r=Is();let o;nt(()=>o=at(r,o,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n},void 0,!0)),st(e,r)}var Ns=ot('<svg><path fill="currentColor" d="m15.07 11.25l-.9.92C13.45 12.89 13 13.5 13 15h-2v-.5c0-1.11.45-2.11 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41a2 2 0 0 0-2-2a2 2 0 0 0-2 2H8a4 4 0 0 1 4-4a4 4 0 0 1 4 4a3.2 3.2 0 0 1-.93 2.25M13 19h-2v-2h2M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10c0-5.53-4.5-10-10-10"></path></svg>');function xi(e,t){const n=it(t,["$$slots","$$events","$$legacy"]);var r=Ns();let o;nt(()=>o=at(r,o,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n},void 0,!0)),st(e,r)}var Us=ot('<svg><path fill="currentColor" d="M12 2c5.53 0 10 4.47 10 10s-4.47 10-10 10S2 17.53 2 12S6.47 2 12 2m3.59 5L12 10.59L8.41 7L7 8.41L10.59 12L7 15.59L8.41 17L12 13.41L15.59 17L17 15.59L13.41 12L17 8.41z"></path></svg>');function vi(e,t){const n=it(t,["$$slots","$$events","$$legacy"]);var r=Us();let o;nt(()=>o=at(r,o,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n},void 0,!0)),st(e,r)}async function Os(e){if(!e.ok)throw new Error(`Network error: ${e.statusText}`);return e.arrayBuffer()}const Ds=e=>An(e);async function Sn(e){const t=await fetch(e),n=await Os(t),r=new Uint8Array(n);return Ds(r)}async function Ms(e){const t=`${e.url}/v1/cids`;return Sn(t)}async function _i(){const e=rt(xt);return(await Promise.all(e.map(n=>Ms(n)))).flat()}async function zs(e,t){const n=`${e.url}/v1/c/${t}`;return Sn(n)}async function Ai(e){const t=rt(xt);return(await Promise.all(t.map(async(r,o)=>{const s=await zs(r,e);return Object.entries(s).map(([i,c])=>({key:i,value:c,sourceEndpoint:r.url,sourceName:r.name,isPrimarySource:o===0}))}))).flat()}const Ei=e=>`${e.slice(0,4)}…${e.slice(-4)}`,ki=e=>Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("");function Si(e,t){if(!t)return;e.preventDefault();const n=new URL(window.location.href);n.searchParams.set("selectedCID",t),window.history.pushState({},"",n),window.dispatchEvent(new Event("popstate"))}function Rs({name:e,code:t,encode:n}){return new Ls(e,t,n)}class Ls{constructor(t,n,r){S(this,"name");S(this,"code");S(this,"encode");this.name=t,this.code=n,this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?Xe(this.code,n):n.then(r=>Xe(this.code,r))}else throw Error("Unknown type, must be binary type")}}function xe({enumerable:e=!0,configurable:t=!1}={}){return{enumerable:e,configurable:t,writable:!1}}function*Fs(e,t){if(t!=null&&typeof t=="object")if(Array.isArray(t))for(const[n,r]of t.entries()){const o=[...e,n],s=B.asCID(r);s!=null?yield[o.join("/"),s]:typeof r=="object"&&(yield*Je(r,o))}else{const n=B.asCID(t);n!=null?yield[e.join("/"),n]:yield*Je(t,e)}}function*Je(e,t){if(e==null||e instanceof Uint8Array)return;const n=B.asCID(e);n!=null&&(yield[t.join("/"),n]);for(const[r,o]of Object.entries(e)){const s=[...t,r];yield*Fs(s,o)}}function*Vs(e,t){if(Array.isArray(t))for(const[n,r]of t.entries()){const o=[...e,n];yield o.join("/"),typeof r=="object"&&B.asCID(r)==null&&(yield*We(r,o))}else yield*We(t,e)}function*We(e,t){if(!(e==null||typeof e!="object"))for(const[n,r]of Object.entries(e)){const o=[...t,n];yield o.join("/"),r!=null&&!(r instanceof Uint8Array)&&typeof r=="object"&&B.asCID(r)==null&&(yield*Vs(o,r))}}function js(e,t){let n=e;for(const[r,o]of t.entries()){if(n=n[o],n==null)throw new Error(`Object has no property at ${t.slice(0,r+1).map(i=>`[${JSON.stringify(i)}]`).join("")}`);const s=B.asCID(n);if(s!=null)return{value:s,remaining:t.slice(r+1).join("/")}}return{value:n}}class Ps{constructor({cid:t,bytes:n,value:r}){S(this,"cid");S(this,"bytes");S(this,"value");S(this,"asBlock");if(t==null||n==null||typeof r>"u")throw new Error("Missing required argument");this.cid=t,this.bytes=n,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:xe(),bytes:xe(),value:xe(),asBlock:xe()})}links(){return Je(this.value,[])}tree(){return We(this.value,[])}get(t="/"){return js(this.value,t.split("/").filter(Boolean))}}async function Tn({value:e,codec:t,hasher:n}){if(typeof e>"u")throw new Error('Missing required argument "value"');if(t==null||n==null)throw new Error("Missing required argument: codec or hasher");const r=t.encode(e),o=await n.digest(r),s=B.create(1,t.code,o);return new Ps({value:e,bytes:r,cid:s})}function qs(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}const Cn=Rs({name:"sha2-256",code:18,encode:qs("SHA-256")});/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const O=2n**255n-19n,Ee=2n**252n+27742317777372353535851937790883648493n,Ht=0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gt=0x6666666666666666666666666666666666666666666666666666666666666658n,Hs=37095705934669439343138083508754565189542113879843219016388785533085940283555n,ve={a:-1n,d:Hs,h:8},D=(e="")=>{throw new Error(e)},Bn=e=>typeof e=="string",Gs=e=>e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array",ge=(e,t)=>!Gs(e)||typeof t=="number"&&t>0&&e.length!==t?D("Uint8Array of valid length expected"):e,oe=e=>new Uint8Array(e),ke=(e,t)=>ge(Bn(e)?_t(e):oe(ge(e)),t),w=(e,t=O)=>{let n=e%t;return n>=0n?n:t+n},Kt=e=>e instanceof M?e:D("Point expected");class M{constructor(t,n,r,o){this.ex=t,this.ey=n,this.ez=r,this.et=o}static fromAffine(t){return new M(t.x,t.y,1n,w(t.x*t.y))}static fromHex(t,n=!1){const{d:r}=ve;t=ke(t,32);const o=t.slice(),s=t[31];o[31]=s&-129;const i=At(o);n&&!(0n<=i&&i<2n**256n)&&D("bad y coord 1"),!n&&!(0n<=i&&i<O)&&D("bad y coord 2");const c=w(i*i),u=w(c-1n),g=w(r*c+1n);let{isValid:l,value:v}=Zs(u,g);l||D("bad y coordinate 3");const y=(v&1n)===1n,A=(s&128)!==0;return!n&&v===0n&&A&&D("bad y coord 3"),A!==y&&(v=w(-v)),new M(v,i,1n,w(v*i))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}equals(t){const{ex:n,ey:r,ez:o}=this,{ex:s,ey:i,ez:c}=Kt(t),u=w(n*c),g=w(s*o),l=w(r*c),v=w(i*o);return u===g&&l===v}is0(){return this.equals(de)}negate(){return new M(w(-this.ex),this.ey,this.ez,w(-this.et))}double(){const{ex:t,ey:n,ez:r}=this,{a:o}=ve,s=w(t*t),i=w(n*n),c=w(2n*w(r*r)),u=w(o*s),g=t+n,l=w(w(g*g)-s-i),v=u+i,y=v-c,A=u-i,d=w(l*y),k=w(v*A),_=w(l*A),C=w(y*v);return new M(d,k,C,_)}add(t){const{ex:n,ey:r,ez:o,et:s}=this,{ex:i,ey:c,ez:u,et:g}=Kt(t),{a:l,d:v}=ve,y=w(n*i),A=w(r*c),d=w(s*v*g),k=w(o*u),_=w((n+r)*(i+c)-y-A),C=w(k-d),x=w(k+d),m=w(A-l*y),p=w(_*C),b=w(x*m),$=w(_*m),I=w(C*x);return new M(p,b,I,$)}mul(t,n=!0){if(t===0n)return n===!0?D("cannot multiply by 0"):de;if(typeof t=="bigint"&&0n<t&&t<Ee||D("invalid scalar, must be < L"),!n&&this.is0()||t===1n)return this;if(this.equals(we))return ni(t).p;let r=de,o=we;for(let s=this;t>0n;s=s.double(),t>>=1n)t&1n?r=r.add(s):n&&(o=o.add(s));return r}multiply(t){return this.mul(t)}clearCofactor(){return this.mul(BigInt(ve.h),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let t=this.mul(Ee/2n,!1).double();return Ee%2n&&(t=t.add(this)),t.is0()}toAffine(){const{ex:t,ey:n,ez:r}=this;if(this.equals(de))return{x:0n,y:1n};const o=In(r,O);return w(r*o)!==1n&&D("invalid inverse"),{x:w(t*o),y:w(n*o)}}toRawBytes(){const{x:t,y:n}=this.toAffine(),r=Ks(n);return r[31]|=t&1n?128:0,r}toHex(){return vt(this.toRawBytes())}}M.BASE=new M(Ht,Gt,1n,w(Ht*Gt));M.ZERO=new M(0n,1n,1n,0n);const{BASE:we,ZERO:de}=M,$n=(e,t)=>e.toString(16).padStart(t,"0"),vt=e=>Array.from(ge(e)).map(t=>$n(t,2)).join(""),q={_0:48,_9:57,A:65,F:70,a:97,f:102},Xt=e=>{if(e>=q._0&&e<=q._9)return e-q._0;if(e>=q.A&&e<=q.F)return e-(q.A-10);if(e>=q.a&&e<=q.f)return e-(q.a-10)},_t=e=>{const t="hex invalid";if(!Bn(e))return D(t);const n=e.length,r=n/2;if(n%2)return D(t);const o=oe(r);for(let s=0,i=0;s<r;s++,i+=2){const c=Xt(e.charCodeAt(i)),u=Xt(e.charCodeAt(i+1));if(c===void 0||u===void 0)return D(t);o[s]=c*16+u}return o},Ks=e=>_t($n(e,32*2)).reverse(),At=e=>BigInt("0x"+vt(oe(ge(e)).reverse())),Qe=(...e)=>{const t=oe(e.reduce((r,o)=>r+ge(o).length,0));let n=0;return e.forEach(r=>{t.set(r,n),n+=r.length}),t},In=(e,t)=>{(e===0n||t<=0n)&&D("no inverse n="+e+" mod="+t);let n=w(e,t),r=t,o=0n,s=1n;for(;n!==0n;){const i=r/n,c=r%n,u=o-s*i;r=n,n=c,o=s,s=u}return r===1n?w(o,t):D("no inverse")},V=(e,t)=>{let n=e;for(;t-- >0n;)n*=n,n%=O;return n},Xs=e=>{const n=e*e%O*e%O,r=V(n,2n)*n%O,o=V(r,1n)*e%O,s=V(o,5n)*o%O,i=V(s,10n)*s%O,c=V(i,20n)*i%O,u=V(c,40n)*c%O,g=V(u,80n)*u%O,l=V(g,80n)*u%O,v=V(l,10n)*s%O;return{pow_p_5_8:V(v,2n)*e%O,b2:n}},Zt=19681161376707505956807079304988542015446066515923890162744021073123829784752n,Zs=(e,t)=>{const n=w(t*t*t),r=w(n*n*t),o=Xs(e*r).pow_p_5_8;let s=w(e*n*o);const i=w(t*s*s),c=s,u=w(s*Zt),g=i===e,l=i===w(-e),v=i===w(-e*Zt);return g&&(s=c),(l||v)&&(s=u),(w(s)&1n)===1n&&(s=w(-s)),{isValid:g||l,value:s}},Ys=e=>w(At(e),Ee);let qe;const Js=(...e)=>Un.sha512Async(...e);function Ws(e,t){return Js(t.hashable).then(t.finish)}const Nn={zip215:!0},Qs=(e,t,n,r=Nn)=>{e=ke(e,64),t=ke(t),n=ke(n,32);const{zip215:o}=r;let s,i,c,u,g=new Uint8Array;try{s=M.fromHex(n,o),i=M.fromHex(e.slice(0,32),o),c=At(e.slice(32,64)),u=we.mul(c,!1),g=Qe(i.toRawBytes(),s.toRawBytes(),t)}catch{}return{hashable:g,finish:v=>{if(u==null||!o&&s.isSmallOrder())return!1;const y=Ys(v);return i.add(s.mul(y,!1)).add(u.negate()).clearCofactor().is0()}}},ei=async(e,t,n,r=Nn)=>Ws(!0,Qs(e,t,n,r)),Yt=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,Un={bytesToHex:vt,hexToBytes:_t,concatBytes:Qe,mod:w,invert:In,randomBytes:(e=32)=>{const t=Yt();return(!t||!t.getRandomValues)&&D("crypto.getRandomValues must be defined"),t.getRandomValues(oe(e))},sha512Async:async(...e)=>{const t=Yt(),n=t&&t.subtle;n||D("etc.sha512Async or crypto.subtle must be defined");const r=Qe(...e);return oe(await n.digest("SHA-512",r.buffer))},sha512Sync:void 0};Object.defineProperties(Un,{sha512Sync:{configurable:!1,get(){return qe},set(e){qe||(qe=e)}}});const W=8,ti=()=>{const e=[],t=256/W+1;let n=we,r=n;for(let o=0;o<t;o++){r=n,e.push(r);for(let s=1;s<2**(W-1);s++)r=r.add(n),e.push(r);n=r.double()}return e};let Jt;const ni=e=>{const t=Jt||(Jt=ti()),n=(l,v)=>{let y=v.negate();return l?y:v};let r=de,o=we;const s=1+256/W,i=2**(W-1),c=BigInt(2**W-1),u=2**W,g=BigInt(W);for(let l=0;l<s;l++){const v=l*i;let y=Number(e&c);e>>=g,y>i&&(y-=u,e+=1n);const A=v,d=v+Math.abs(y)-1,k=l%2!==0,_=y<0;y===0?o=o.add(n(k,t[A])):r=r.add(n(_,t[d]))}return{p:r,f:o}},K=new Map,ri=5*60*1e3;async function Ti(e,t,n){switch(e){case"hash":return{status:t.value.attestation.CID.toString()===n?"verified":"unverified"};case"signature":if(t.value.signature){const{valid:r,knownKey:o,keyName:s}=await oi(t.value);return r&&o?{status:"verified",knownKey:o,keyName:s}:r&&!o?{status:"unknown_key",knownKey:!1}:{status:"present",knownKey:o}}return{status:"unverified"};case"timestamp":if(console.log("Timestamp present:",!!t.value.timestamp),console.log("OTS present:",t.value.timestamp?!!t.value.timestamp.ots:!1),t.value.timestamp&&t.value.timestamp.ots){const r=t.value.timestamp.ots.msg.toString(),o=K.get(r);if(o&&new Date().getTime()-o.timestamp.getTime()<3e4)return{status:"cached",cachedValue:o.result,cacheTimestamp:o.timestamp};try{return{status:await si(t.value)?"verified":"present"}}catch(s){return console.log("Error verifying timestamp:",s),{status:"present"}}}return{status:"unverified"};default:return console.log("Unknown kind:",e),{status:"unverified"}}}const oi=async e=>{const t=rt(Ts),n=Array.from(e.signature.pubKey).map(c=>c.toString(16).padStart(2,"0")).join(""),r=t.find(c=>c.key===n),o=!!r;return(await Tn({value:e.attestation,codec:En,hasher:Cn})).cid.equals(e.signature.msg)?{valid:await ei(e.signature.sig,e.signature.msg.bytes,e.signature.pubKey),knownKey:o,keyName:r==null?void 0:r.name}:{valid:!1,knownKey:o,keyName:r==null?void 0:r.name}},si=async e=>{if(!e.timestamp||!e.timestamp.ots||!e.timestamp.ots.msg)return console.log("Timestamp data is missing required fields:",e.timestamp),!1;const t=e.timestamp.ots.msg.toString(),n=K.get(t);if(n){if(new Date().getTime()-n.timestamp.getTime()<ri)return console.log(`Using cached timestamp verification result for ${t}`),n.result;K.delete(t)}const r=window.OpenTimestamps;if(!r)return console.error("OpenTimestamps library not found on window object"),!1;console.log("Asset timestamp:",e.timestamp);try{if((await Tn({value:{signature:e.signature,attestation:e.attestation},codec:En,hasher:Cn})).cid.toString()!==e.timestamp.ots.msg.toString())return console.log("CID mismatch for timestamp, verification skipped"),K.set(t,{timestamp:new Date,result:!1}),!1}catch(o){return console.error("Error during CID verification:",o),K.set(t,{timestamp:new Date,result:!1}),!1}try{if(!e.timestamp.ots.proof||!(e.timestamp.ots.proof instanceof Uint8Array))return console.log("Missing or invalid timestamp proof data:",e.timestamp.ots.proof),K.set(t,{timestamp:new Date,result:!1}),!1;const o=new TextEncoder().encode(e.timestamp.ots.msg.toString()),s=e.timestamp.ots.proof;console.log("Timestamp data for verification:"),console.log("- File length:",o.length),console.log("- OTS proof length:",s.length);const i=r.DetachedTimestampFile.fromBytes(new r.Ops.OpSHA256,o),c=r.DetachedTimestampFile.deserialize(s);let u;console.log(`Verifying timestamp for ${t} with OpenTimestamps...`),u=r.verify(c,i,{ignoreBitcoinNode:!0});const g=u!=null;return g&&u&&console.log("Verification details:",u),K.set(t,{timestamp:new Date,result:g}),g}catch(o){return console.log(o),K.set(t,{timestamp:new Date,result:!1}),!1}};export{bi as C,xi as H,di as a,pi as b,kn as c,yi as d,xt as e,vi as f,gi as g,mi as h,li as i,He as j,wi as k,Ei as l,Ts as m,Si as n,Ai as o,_i as p,hi as r,at as s,ki as u,Ti as v};
