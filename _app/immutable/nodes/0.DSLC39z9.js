import{c as N,e as D,a as t,t as n,s as X,n as at,b as ze}from"../chunks/nuOQF-VX.js";import{C as We,D as rt,B as st,E as it,K as ot,P as nt,as as lt,M as vt,p as Re,at as dt,i as f,j as Ue,au as ct,k as r,l as a,s as o,t as Y,v as k,a8 as ut,av as Q,g as e,aw as we,ax as pt,X as ke,ay as O}from"../chunks/gyiEl3Uc.js";import{i as Oe}from"../chunks/BkNFsCzC.js";import{p as Fe,i as v,r as ft,s as mt,b as gt}from"../chunks/CtItQhWX.js";import{s as _t,e as Xe,a as ht,r as Ye,b as Ge,i as bt,v as xt,c as yt,h as wt,u as Je,d as kt,C as Qe,H as He,f as Tt,g as Ct}from"../chunks/lL0d4sFs.js";function Dt(M,d,y,s,u){var l;We&&rt();var i=(l=d.$$slots)==null?void 0:l[y],w=!1;i===!0&&(i=d.children,w=!0),i===void 0||i(M,w?()=>s:s)}function Mt(M,d,...y){var s=M,u=nt,i;st(()=>{u!==(u=d())&&(i&&(lt(i),i=null),i=ot(()=>u(s,...y)))},it),We&&(s=vt)}var Et=n('<div class="fixed inset-0 bg-black/60 flex items-center justify-center z-50" role="button" tabindex="0"><div class="bg-white rounded-lg p-6 max-w-xl w-full max-h-[90vh] overflow-auto" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-4"><h2 class="text-xl font-bold"> </h2> <button class="text-gray-500 hover:text-gray-700">✕</button></div> <div class="mb-4"><!></div> <div class="flex justify-end"><button class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Close</button></div></div></div>');function Ze(M,d){Re(d,!1);let y=Fe(d,"showModal",12),s=Fe(d,"title",8,"");const u=dt();function i(){y(!1),u("close")}function w(p){p.key==="Escape"&&i()}function l(p){p.target===p.currentTarget&&i()}Oe();var m=N();D("keydown",ct,w);var U=f(m);{var c=p=>{var B=Et(),g=r(B),h=r(g),T=r(h),G=r(T,!0);a(T);var le=o(T,2);a(h);var se=o(h,2),Te=r(se);Dt(Te,d,"default",{}),a(se);var q=o(se,2),_e=r(q);a(q),a(g),a(B),Y(()=>X(G,s())),D("click",le,i),D("click",_e,i),D("click",B,l),D("keydown",B,w),t(p,B)};v(U,p=>{y()&&p(c)})}t(M,m),Ue()}var St=at('<svg><path fill="currentColor" d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5a3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97s-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1s.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64z"></path></svg>');function At(M,d){const y=ft(d,["$$slots","$$events","$$legacy"]);var s=St();let u;Y(()=>u=_t(s,u,{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...y},void 0,!0)),t(M,s)}var Vt=n('<button class="p-1 text-red-500 hover:text-red-700" title="Remove endpoint">✕</button>'),It=n('<div class="flex items-center gap-2 p-2 bg-gray-50 rounded border border-gray-200 svelte-1kec5vf" draggable="true"><div class="cursor-move p-1 svelte-1kec5vf">☰</div> <div class="flex-grow grid grid-cols-2 gap-2"><input type="text" class="p-2 border border-gray-300 rounded" placeholder="Display Name"> <input type="text" class="p-2 border border-gray-300 rounded" placeholder="URL"></div> <!></div>'),Nt=n('<div class="mb-4"><p class="text-sm text-gray-600 mb-2">Configure and reorder the endpoints. The first endpoint will be considered the primary source.</p> <div class="endpoints-list space-y-2 svelte-1kec5vf"></div> <div class="mt-4 flex justify-between"><button class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300">+ Add Endpoint</button> <button class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Save Changes</button></div></div>');function Lt(M,d){Re(d,!1);let y=Fe(d,"showModal",12,!1),s=Q([]);const u=Xe.subscribe(g=>{k(s,g.map((h,T)=>({name:h.name,url:h.url,id:`endpoint-${T}`})))});ut(()=>()=>{u()});function i(){const g=e(s).map(h=>({name:h.name,url:h.url}));Xe.set(g),y(!1)}function w(){const g={name:"New Endpoint",url:"https://"};k(s,[...e(s),{...g,id:`endpoint-${e(s).length}`}])}function l(g){k(s,e(s).filter((h,T)=>T!==g))}function m(g,h,T){const G=[...e(s)];G[g][h]=T,k(s,G)}let U;function c(g){U=g}function p(g){g.preventDefault()}function B(g){if(U===void 0)return;const h=[...e(s)],[T]=h.splice(U,1);h.splice(g,0,T),k(s,h),U=void 0}Oe(),Ze(M,{get showModal(){return y()},title:"Endpoint Settings",children:(g,h)=>{var T=Nt(),G=o(r(T),2);ht(G,5,()=>e(s),bt,(q,_e,ve)=>{var de=It(),ce=o(r(de),2),ie=r(ce);Ye(ie);var Ce=o(ie,2);Ye(Ce),a(ce);var Ne=o(ce,2);{var je=W=>{var Le=Vt();D("click",Le,()=>l(ve)),t(W,Le)};v(Ne,W=>{e(s).length>1&&W(je)})}a(de),Y(()=>{Ge(ie,e(_e).name),Ge(Ce,e(_e).url)}),D("input",ie,W=>m(ve,"name",W.currentTarget.value)),D("input",Ce,W=>m(ve,"url",W.currentTarget.value)),D("dragstart",de,()=>c(ve)),D("dragover",de,p),D("drop",de,()=>B(ve)),t(q,de)}),a(G);var le=o(G,2),se=r(le),Te=o(se,2);a(le),a(T),D("click",se,w),D("click",Te,i),t(g,T)},$$slots:{default:!0}}),Ue()}var Rt=n('<div class="settings-button svelte-1so8a75"><button class="p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-full transition-colors" title="Settings"><!></button> <!></div>');function Ut(M){let d=Q(!1);function y(){k(d,!e(d))}var s=Rt(),u=r(s),i=r(u);At(i,{class:"h-6 w-6"}),a(u);var w=o(u,2);Lt(w,{get showModal(){return e(d)},set showModal(l){k(d,l)},$$legacy:!0}),a(s),D("click",u,y),t(M,s)}var jt=n('<div class="flex justify-center"><div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"></div></div>'),Bt=n('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"><strong class="font-bold">Error:</strong> <span class="block sm:inline"> </span></div>'),Pt=n('<p class="mt-2 text-sm">The attestation CID matches the selected CID.</p>'),Kt=n("– that of: <strong> </strong>.",1),qt=n('<p class="mt-2 text-sm">The digital signature is valid and was created with a known public key <!></p>'),zt=n('<p class="mt-2 text-sm">The timestamp proof is valid and anchored in the Bitcoin blockchain.</p>'),Ht=n('<div class="flex items-center"><!> <span>Verification successful!</span></div> <!>',1),Ft=n(`<p class="mt-2 text-sm">The timestamp proof was recently verified and is valid. Using cached result to
									reduce blockchain queries.</p> <p class="mt-2 text-xs text-gray-600">Note: Cache expires after 5 minutes. Results from a fresh verification will be
									shown then.</p>`,1),Ot=n('<div class="flex items-center"><!> <span>Verification successful! (cached result)</span></div> <!>',1),Xt=n(`<p class="mt-2 text-sm">The timestamp was recently checked and couldn't be verified. Using cached result
									to reduce blockchain queries.</p> <p class="mt-2 text-xs text-gray-600">Note: Cache expires after 5 minutes. Results from a fresh verification will be
									shown then.</p>`,1),Yt=n('<div class="flex items-center"><!> <span>Verification failed! (cached result)</span></div> <!>',1),Gt=n('<div class="flex items-center"><!> <span>Signature verifies but is from an unknown public key</span></div> <p class="mt-2 text-sm">The signature is valid but was created with an unknown public key.</p>',1),Jt=n('<p class="mt-2 text-sm">The signature exists but failed cryptographic verification. This could be due to:</p> <ul class="list-disc pl-5 mt-1"><li>The signature is invalid or has been tampered with</li> <li>The data was modified after signing</li></ul>',1),Qt=n(`<p class="mt-2 text-sm">The timestamp exists but could not be verified. This could be due to:</p> <ul class="list-disc text-sm pl-5 mt-1"><li>The timestamp proof isn't properly formatted</li> <li>The timestamp hasn't been anchored in the blockchain yet</li> <li>The data was modified after timestamping</li></ul>`,1),Wt=n('<div class="flex items-center"><!> <span><!></span></div> <!>',1),Zt=n('<p class="mt-2 text-sm">The attestation CID does not match the selected CID.</p>'),$t=n('<p class="mt-2 text-sm">No signature was found for this attestation.</p>'),ea=n('<p class="mt-2 text-sm">No timestamp was found for this attestation.</p>'),ta=n('<div class="flex items-center"><!> <span>Verification failed!</span></div> <!>',1),aa=n("<div><!></div>"),ra=n('<div class="mt-4 border-t pt-4"><h3 class="font-semibold mb-2">Technical Details</h3> <div class="bg-gray-100 p-3 rounded text-sm font-mono overflow-x-auto"><p> </p> <p> </p></div></div>'),sa=n('<div class="mt-4 border-t pt-4"><h3 class="font-semibold mb-2">Technical Details</h3> <div class="bg-gray-100 p-3 rounded text-sm font-mono"><p>Public Key:</p> <pre class="whitespace-pre-wrap break-all bg-gray-200 p-2 rounded"> </pre> <p class="mt-3">Signature:</p> <pre class="whitespace-pre-wrap break-all bg-gray-200 p-2 rounded"> </pre></div></div>'),ia=n('<p class="text-gray-600"> </p>'),oa=n('<div class="mt-4 border-t pt-4"><h3 class="font-semibold mb-2">Technical Details</h3> <div class="bg-gray-100 p-3 rounded text-sm font-mono overflow-x-auto"><p> </p> <p> </p> <!></div></div>'),na=n('<div class="space-y-4"><p class="text-gray-700"> </p> <!> <!></div>');function la(M,d){Re(d,!1);const[y,s]=mt(),u=()=>gt(yt,"$verificationModalStore",y),i=Q(),w=Q(),l=Q(),m=Q(),U=Q();let c=Q(null),p=Q(!0),B=Q(null);async function g(){k(p,!0),k(B,null);try{k(c,await xt(e(l),e(m),e(U))),k(p,!1)}catch(q){k(B,q instanceof Error?q.message:"Unknown error occurred"),k(p,!1)}}function h(){return`${e(l).charAt(0).toUpperCase()+e(l).slice(1)} Verification`}function T(){switch(e(l)){case"hash":return"Verifying the attestation's hash.";case"signature":return"Verifying the digital signature using the embedded public key.";case"timestamp":return"Verifying the OpenTimestamps proof against Bitcoin blockchain.";default:return"Unknown verification type."}}function G(){wt()}we(()=>u(),()=>{k(i,u())}),we(()=>e(i),()=>{k(w,e(i).show)}),we(()=>e(i),()=>{k(l,e(i).kind)}),we(()=>e(i),()=>{k(m,e(i).data)}),we(()=>e(i),()=>{k(U,e(i).selectedCID)}),we(()=>(e(w),e(m)),()=>{e(w)&&e(m)&&g()}),pt(),Oe();var le=N(),se=f(le);{var Te=q=>{const _e=ke(h);Ze(q,{get title(){return e(_e)},get showModal(){return e(w)},$$events:{close:G},children:(ve,de)=>{var ce=na(),ie=r(ce),Ce=r(ie,!0);a(ie);var Ne=o(ie,2);{var je=E=>{var z=jt();t(E,z)},W=E=>{var z=N(),he=f(z);{var ue=C=>{var S=Bt(),H=o(r(S),2),Z=r(H,!0);a(H),a(S),Y(()=>X(Z,e(B))),t(C,S)},De=C=>{var S=N(),H=f(S);{var Z=$=>{var F=aa(),be=r(F);{var pe=J=>{var fe=Ht(),me=f(fe),Ee=r(me);Qe(Ee,{class:"w-6 h-6 text-green-500 mr-2"}),O(2),a(me);var ee=o(me,2);{var P=K=>{var oe=Pt();t(K,oe)},te=K=>{var oe=N(),Se=f(oe);{var A=b=>{var L=qt(),ae=o(r(L));{var R=_=>{var re=Kt(),ge=o(f(re)),Ae=r(ge,!0);a(ge),O(),Y(()=>X(Ae,e(c).keyName)),t(_,re)},x=_=>{var re=ze(".");t(_,re)};v(ae,_=>{e(c).keyName?_(R):_(x,!1)})}a(L),t(b,L)},j=b=>{var L=N(),ae=f(L);{var R=x=>{var _=zt();t(x,_)};v(ae,x=>{e(l)==="timestamp"&&x(R)},!0)}t(b,L)};v(Se,b=>{e(l)==="signature"?b(A):b(j,!1)},!0)}t(K,oe)};v(ee,K=>{e(l)==="hash"?K(P):K(te,!1)})}t(J,fe)},Me=J=>{var fe=N(),me=f(fe);{var Ee=P=>{var te=N(),K=f(te);{var oe=A=>{var j=Ot(),b=f(j),L=r(b);Qe(L,{class:"w-6 h-6 text-green-500 mr-2 opacity-90"}),O(2),a(b);var ae=o(b,2);{var R=x=>{var _=Ft();O(2),t(x,_)};v(ae,x=>{e(l)==="timestamp"&&x(R)})}t(A,j)},Se=A=>{var j=Yt(),b=f(j),L=r(b);He(L,{class:"w-6 h-6 text-red-500 mr-2 opacity-90"}),O(2),a(b);var ae=o(b,2);{var R=x=>{var _=Xt();O(2),t(x,_)};v(ae,x=>{e(l)==="timestamp"&&x(R)})}t(A,j)};v(K,A=>{e(c).cachedValue?A(oe):A(Se,!1)})}t(P,te)},ee=P=>{var te=N(),K=f(te);{var oe=A=>{var j=Gt(),b=f(j),L=r(b);He(L,{class:"w-6 h-6 text-orange-500 mr-2"}),O(2),a(b),O(2),t(A,j)},Se=A=>{var j=N(),b=f(j);{var L=R=>{var x=Wt(),_=f(x),re=r(_);He(re,{class:"w-6 h-6 text-red-500 mr-2"});var ge=o(re,2),Ae=r(ge);{var Be=V=>{var I=ze("Signature exists but doesn't verify cryptographically");t(V,I)},ne=V=>{var I=ze("Timestamp present but doesn't verify");t(V,I)};v(Ae,V=>{e(l)==="signature"?V(Be):V(ne,!1)})}a(ge),a(_);var xe=o(_,2);{var Pe=V=>{var I=Jt();O(2),t(V,I)},Ke=V=>{var I=N(),ye=f(I);{var qe=Ve=>{var Ie=Qt();O(2),t(Ve,Ie)};v(ye,Ve=>{e(l)==="timestamp"&&Ve(qe)},!0)}t(V,I)};v(xe,V=>{e(l)==="signature"?V(Pe):V(Ke,!1)})}t(R,x)},ae=R=>{var x=ta(),_=f(x),re=r(_);Tt(re,{class:"w-6 h-6 text-red-500 mr-2"}),O(2),a(_);var ge=o(_,2);{var Ae=ne=>{var xe=Zt();t(ne,xe)},Be=ne=>{var xe=N(),Pe=f(xe);{var Ke=I=>{var ye=$t();t(I,ye)},V=I=>{var ye=N(),qe=f(ye);{var Ve=Ie=>{var tt=ea();t(Ie,tt)};v(qe,Ie=>{e(l)==="timestamp"&&Ie(Ve)},!0)}t(I,ye)};v(Pe,I=>{e(l)==="signature"?I(Ke):I(V,!1)},!0)}t(ne,xe)};v(ge,ne=>{e(l)==="hash"?ne(Ae):ne(Be,!1)})}t(R,x)};v(b,R=>{e(c).status==="present"?R(L):R(ae,!1)},!0)}t(A,j)};v(K,A=>{e(c).status==="unknown_key"?A(oe):A(Se,!1)},!0)}t(P,te)};v(me,P=>{e(c).status==="cached"?P(Ee):P(ee,!1)},!0)}t(J,fe)};v(be,J=>{e(c).status==="verified"?J(pe):J(Me,!1)})}a(F),Y(()=>kt(F,`${e(c).status==="verified"?"bg-green-100 border border-green-400 text-green-700":e(c).status==="cached"&&e(c).cachedValue?"bg-green-100 border border-green-400 text-green-700 opacity-90":e(c).status==="unknown_key"?"bg-orange-100 border border-orange-400 text-orange-700":e(c).status==="present"?"bg-orange-100 border border-red-400 text-red-700":"bg-red-100 border border-red-400 text-red-700"} px-4 py-3 rounded relative`)),t($,F)};v(H,$=>{e(c)&&$(Z)},!0)}t(C,S)};v(he,C=>{e(B)?C(ue):C(De,!1)},!0)}t(E,z)};v(Ne,E=>{e(p)?E(je):E(W,!1)})}var Le=o(Ne,2);{var $e=E=>{var z=ra(),he=o(r(z),2),ue=r(he),De=r(ue);a(ue);var C=o(ue,2),S=r(C);a(C),a(he),a(z),Y(H=>{X(De,`Selected CID: ${e(U)||"None"}`),X(S,`Attestation CID: ${H??""}`)},[()=>e(m).value.attestation.CID.toString()],ke),t(E,z)},et=E=>{var z=N(),he=f(z);{var ue=C=>{var S=sa(),H=o(r(S),2),Z=o(r(H),2),$=r(Z,!0);a(Z);var F=o(Z,4),be=r(F);a(F),a(H),a(S),Y((pe,Me)=>{X($,pe),X(be,`							${Me??""}
						`)},[()=>Je(e(m).value.signature.pubKey),()=>Je(e(m).value.signature.sig)],ke),t(C,S)},De=C=>{var S=N(),H=f(S);{var Z=$=>{var F=oa(),be=o(r(F),2),pe=r(be),Me=r(pe);a(pe);var J=o(pe,2),fe=r(J);a(J);var me=o(J,2);{var Ee=ee=>{var P=ia(),te=r(P);a(P),Y(K=>X(te,`Cached: ${K??""}`),[()=>e(c).cacheTimestamp.toLocaleString()],ke),t(ee,P)};v(me,ee=>{e(c)&&e(c).status==="cached"&&e(c).cacheTimestamp&&ee(Ee)})}a(be),a(F),Y(ee=>{X(Me,`Timestamp Message: ${ee??""}`),X(fe,`Upgraded: ${(e(m).value.timestamp.ots.upgraded?"Yes":"No")??""}`)},[()=>e(m).value.timestamp.ots.msg.toString()],ke),t($,F)};v(H,$=>{e(l)==="timestamp"&&!e(p)&&e(m)&&$(Z)},!0)}t(C,S)};v(he,C=>{e(l)==="signature"&&!e(p)&&e(m)?C(ue):C(De,!1)},!0)}t(E,z)};v(Le,E=>{e(l)==="hash"&&!e(p)&&e(m)?E($e):E(et,!1)})}a(ce),Y(E=>X(Ce,E),[T],ke),t(ve,ce)},$$slots:{default:!0}})};v(se,q=>{e(w)&&e(m)&&q(Te)})}t(M,le),Ue(),s()}var va=n('<div class="navbar sticky top-0 bg-white shadow-md z-50"><div class="logo"><img src="/logo.png" alt="AA Explorer Logo" class="logo-img"> <span>Authenticated Attributes Explorer</span></div> <div class="navbar-right"><!></div></div> <!> <div class="modal-container"><!></div>',1);function ma(M,d){Re(d,!0);function y(){Ct.set(null);const p=new URL(window.location.href);p.searchParams.delete("selectedCID"),window.history.pushState({},"",p),window.dispatchEvent(new Event("popstate"))}var s=va(),u=f(s),i=r(u),w=o(i,2),l=r(w);Ut(l),a(w),a(u);var m=o(u,2);Mt(m,()=>d.children);var U=o(m,2),c=r(U);la(c,{}),a(U),D("click",i,y),D("keydown",i,p=>p.key==="Enter"&&y()),t(M,s),Ue()}export{ma as component};
